import mechanize
import cookielib
import re
import urllib

url = 'https://www.facebook.com'
loggedin_title = 'Facebook'
username = '**********'
password = '**********'

browser = mechanize.Browser()

cj = cookielib.LWPCookieJar()
browser.set_cookiejar(cj)
browser.set_handle_robots(False)
browser.addheaders = [('User-Agent', 'Mozilla/5.0 (Windows; U; Windows NT 6.0; en-US; rv:1.9.0.6)')]

browser.open(url)
browser.select_form(nr=0)
browser.form["email"] = username
browser.form["pass"] = password
browser.submit()

if browser.title() == loggedin_title:
    x = browser.open("https://www.facebook.com/search/str/?q='keywords'")
    html = x.read()
    x = re.findall('permalink:"(.*?)"', html, re.I|re.M)
    for r in x:
        print "post: ",r
        url2 = "https://www.facebook.com{}".format(r)
        y = browser.open(url2)
        html2 = y.read()
        o = re.findall('<div class="_5pbx userContent" data-ft="&#123;&quot;tn&quot;:&quot;K&quot;&#125;">(.*?)<\/div>',html2, re.I|re.M)
        print o
else:
    print '[-] LOGIN FAILED'
